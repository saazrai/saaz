<?php

namespace Database\Seeders\Diagnostics;

class D7ThreatVulnerabilityManagementSeeder extends BaseDiagnosticSeeder
{
    protected string $domainName = 'Threat & Vulnerability Management';

    protected function getQuestions(): array
    {
        return [
            // Topic 1: Threat Actors (10 questions)
            // Bloom Distribution: L1:1, L2:2, L3:3, L4:2, L5:2

            // Item 1 - L1 - Remember
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Threat Actor Types',
                'question' => 'A security analyst receives an alert to expect increased and highly advanced cyberattacks originating from a foreign country that recently had sanctions implemented. Which of the following describes the type of threat actors that should concern the security analyst?',
                'options' => [
                    'Black hat',
                    'Nation-state',
                    'Hacktivist',
                    'Organized crime',
                ],
                'correct_options' => ['Nation-state'],
                'justifications' => [
                    'Incorrect - Black hat refers to malicious hackers in general, not specifically state-sponsored actors with geopolitical motivations',
                    'Correct - Nation-state actors are government-sponsored threat actors who conduct cyber operations in response to geopolitical events like sanctions',
                    'Incorrect - While hacktivists may be motivated by political causes, they typically lack the advanced capabilities and resources described',
                    'Incorrect - Organized crime groups are primarily motivated by financial gain rather than geopolitical retaliation',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 2,
                'irt_a' => 0.9,
                'irt_b' => -1.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 2 - L2 - Understand
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Threat Actor Types',
                'question' => 'How do the motivations of cybercriminals differ from those of nation-state actors?',
                'options' => [
                    'Both groups have identical motivations and targets',
                    'Cybercriminals focus on financial gain while nation-states pursue espionage and strategic advantage',
                    'Nation-states only attack military targets while cybercriminals target civilians',
                    'Cybercriminals are more sophisticated than nation-state actors',
                ],
                'correct_options' => ['Cybercriminals focus on financial gain while nation-states pursue espionage and strategic advantage'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Cybercriminals focus on financial gain while nation-states pursue espionage and strategic advantage',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 3,
                'irt_a' => 1.2,
                'irt_b' => -0.5,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 3 - L2 - Understand
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Insider Threat Categories',
                'question' => 'Why are insider threats particularly challenging to detect and prevent?',
                'options' => [
                    'Insiders are always more technically skilled than external attackers',
                    'Insiders have legitimate access and knowledge of systems and processes',
                    'Traditional security tools don\'t work on insider activities',
                    'Insider threats are less damaging than external attacks',
                ],
                'correct_options' => ['Insiders have legitimate access and knowledge of systems and processes'],
                'justifications' => [
                    'Incorrect - This is too absolute or limiting',
                    'Correct - Insiders have legitimate access and knowledge of systems and processes',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 3,
                'irt_a' => 1.3,
                'irt_b' => -0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 4 - L3 - Apply
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Threat Actor Types',
                'question' => 'Your organization detects reconnaissance activity including port scans and DNS enumeration from multiple IP addresses over several weeks. What type of threat actor does this suggest?',
                'options' => [
                    'Script kiddies conducting random attacks',
                    'APT group conducting systematic intelligence gathering',
                    'Automated malware performing network propagation',
                    'Legitimate security scanning by vendors',
                ],
                'correct_options' => ['APT group conducting systematic intelligence gathering'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - APT group conducting systematic intelligence gathering',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.1,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 5 - L3 - Apply
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Insider Threat Categories',
                'question' => 'How should you tailor your security controls when facing primarily financially motivated cybercriminals versus nation-state actors?',
                'options' => [
                    'Use identical controls for both threat types',
                    'Focus on data exfiltration prevention for criminals, espionage detection for nation-states',
                    'Only implement controls for the most sophisticated threats',
                    'Cybercriminals require more advanced controls than nation-states',
                ],
                'correct_options' => ['Focus on data exfiltration prevention for criminals, espionage detection for nation-states'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Focus on data exfiltration prevention for criminals, espionage detection for nation-states',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.5,
                'irt_b' => 0.3,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 6 - L3 - Apply
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Insider Threat Categories',
                'question' => 'What is the most appropriate response when you suspect an insider threat but lack conclusive evidence?',
                'options' => [
                    'Immediately terminate the suspected employee',
                    'Increase monitoring and implement additional controls while following legal protocols',
                    'Ignore the suspicion until concrete evidence emerges',
                    'Publicly announce the investigation to deter other potential insiders',
                ],
                'correct_options' => ['Increase monitoring and implement additional controls while following legal protocols'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Increase monitoring and implement additional controls while following legal protocols',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.5,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 7 - L4 - Analyze
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Insider Threat Categories',
                'question' => 'During a routine security audit, it is discovered that an employee regularly emails sensitive customer data to their personal Gmail account, claiming it\'s "easier for remote work." This practice violates company policy, and the employee was previously trained on data handling protocols. While there\'s no evidence of malicious intent to sell or leak the data externally, this action significantly increases the risk of a data breach. This scenario is BEST classified as which type of threat?',
                'options' => [
                    'Intentional insider threat - The employee deliberately violated policy',
                    'Unintentional insider threat - There was no malicious intent behind the action',
                    'Malicious insider threat - Policy violations always indicate malicious intent',
                    'Negligent insider threat - The employee disregarded known security protocols for convenience',
                ],
                'correct_options' => ['Negligent insider threat - The employee disregarded known security protocols for convenience'],
                'justifications' => [
                    'Incorrect - While the action was deliberate, the lack of malicious intent and convenience-driven motive make this negligent rather than intentional',
                    'Incorrect - The employee knowingly violated policy after receiving training, which goes beyond unintentional behavior',
                    'Incorrect - Malicious intent requires evidence of harmful purpose; convenience-driven policy violations are typically negligent',
                    'Correct - This demonstrates negligent behavior: knowingly disregarding security protocols (after training) for personal convenience, without malicious intent but creating significant security risk',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.3,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 8 - L5 - Evaluate
            [
                'topic' => 'TTPs',
                'subtopic' => 'Tactics, Techniques, Procedures',
                'question' => 'Consider the following two adversary behaviors:

**Behavior X:** An attacker\'s goal is to gain control over compromised systems to execute arbitrary commands.

**Behavior Y:** An attacker specifically uses rundll32.exe with a particular command-line argument to execute a malicious DLL from a known directory.

How do Behavior X and Behavior Y primarily differ in the context of TTPs?',
                'options' => [
                    'Behavior X describes a Tactic, while Behavior Y describes a Technique.',
                    'Behavior X describes a Technique, while Behavior Y describes a Procedure.',
                    'Behavior X describes a Tactic, while Behavior Y describes a Procedure.',
                    'Both Behavior X and Behavior Y describe Techniques, but at different levels of granularity.',
                ],
                'correct_options' => ['Behavior X describes a Tactic, while Behavior Y describes a Procedure.'],
                'justifications' => [
                    'Incorrect - Behavior Y is too specific to be just a technique; it describes detailed implementation steps',
                    'Incorrect - Behavior X describes a high-level goal/objective (tactic), not a specific method (technique)',
                    'Correct - Behavior X describes a high-level adversary goal (tactic), while Behavior Y describes specific implementation details with particular tools and arguments (procedure)',
                    'Incorrect - The behaviors operate at fundamentally different levels of the TTP hierarchy, not just different granularity within the same level',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.8,
                'irt_b' => 1.0,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 9 - L4 - Analyze
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Insider Threat Categories',
                'question' => 'A cybersecurity manager must prioritize resources to mitigate insider threats. Which of the following is the MOST effective action for reducing unintentional insider threats?',
                'options' => [
                    'Deploy user behavior analytics tools.',
                    'Conduct frequent phishing simulations and security training.',
                    'Restrict access to privileged users only.',
                    'Monitor data exfiltration in real time.',
                ],
                'correct_options' => ['Conduct frequent phishing simulations and security training.'],
                'justifications' => [
                    'Incorrect - UBA tools are valuable for detection but don\'t prevent unintentional threats caused by lack of awareness',
                    'Correct - Training and awareness programs directly address the root cause of unintentional insider threats by improving security knowledge',
                    'Incorrect - Access restrictions may reduce exposure but don\'t address the underlying cause of unintentional threats',
                    'Incorrect - Monitoring detects threats but doesn\'t prevent unintentional actions that cause security incidents',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.7,
                'irt_b' => 0.8,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 10 - L2 - Understand
            [
                'topic' => 'Threat Actors',
                'subtopic' => 'Threat Actor Types',
                'question' => 'Match the threat actor types with their primary motivations.',
                'type_id' => 5, // Matching
                'options' => [
                    'Nation-State Actors',
                    'Organized Crime Groups',
                    'Hacktivist Groups',
                    'Insider Threats',
                ],
                'correct_options' => [
                    'Political or strategic intelligence gathering',
                    'Financial gain through cybercrime',
                    'Ideological or social causes',
                    'Personal grievances or financial pressures',
                ],
                'matching_pairs' => [
                    'Nation-State Actors' => 'Political or strategic intelligence gathering',
                    'Organized Crime Groups' => 'Financial gain through cybercrime',
                    'Hacktivist Groups' => 'Ideological or social causes',
                    'Insider Threats' => 'Personal grievances or financial pressures',
                ],
                'justifications' => [
                    'Nation-State Actors are typically motivated by espionage, surveillance, and strategic intelligence gathering for national interests',
                    'Organized Crime Groups primarily seek financial profit through ransomware, fraud, and other monetizable cybercrimes',
                    'Hacktivist Groups are driven by political or social ideologies and seek to promote their causes through cyber activities',
                    'Insider Threats often act due to personal grievances against the organization or financial pressures and opportunities',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.3,
                'irt_b' => -0.1,
                'irt_c' => 0.25,
                'status' => 'published',

            ],

            // Topic 2: TTPs (Tactics, Techniques, and Procedures) (10 questions)
            // Bloom Distribution: L1:1, L2:2, L3:3, L4:2, L5:2

            // Item 11 - L5 - Evaluate
            [
                'topic' => 'TTPs',
                'subtopic' => 'MITRE ATT&CK Framework',
                'question' => 'Evaluate the decision of an organization to base their entire security strategy exclusively on MITRE ATT&CK framework mappings, claiming it provides "complete coverage" of all possible threats. What are the limitations and risks of this approach?',
                'options' => [
                    'ATT&CK provides perfect coverage and this approach eliminates all security gaps',
                    'Over-reliance on ATT&CK may miss organization-specific risks, novel attacks, and operational security contexts',
                    'ATT&CK should never be used for security planning purposes',
                    'Framework-based approaches are always superior to custom security strategies',
                ],
                'correct_options' => ['Over-reliance on ATT&CK may miss organization-specific risks, novel attacks, and operational security contexts'],
                'justifications' => [
                    'Incorrect - This overstates ATT&CK\'s coverage and ignores its limitations',
                    'Correct - While valuable, ATT&CK should complement, not replace, comprehensive threat modeling and risk assessment',
                    'Incorrect - ATT&CK is valuable when used appropriately as part of broader security strategy',
                    'Incorrect - Effective security requires both framework guidance and context-specific customization',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.4,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 12 - L5 - Evaluate
            [
                'topic' => 'TTPs',
                'subtopic' => 'TTP Attribution',
                'question' => 'You are a threat intelligence analyst tasked with providing the most actionable information to your organization\'s security operations center (SOC) for detection and prevention. You have identified that a new threat actor is targeting your industry. Which level of TTP detail (Tactic, Technique, or Procedure) would be most critical for the SOC to focus on for effective short-term defensive measures, and why?',
                'options' => [
                    'Tactic, because understanding the adversary\'s overall objective allows for broad defensive strategy.',
                    'Technique, because it provides concrete methods to develop detection rules and apply specific controls.',
                    'Procedure, because its unique details are essential for attributing attacks to specific threat actors.',
                    'All three levels equally, as they are all interconnected and necessary for comprehensive defense.',
                ],
                'correct_options' => ['Technique, because it provides concrete methods to develop detection rules and apply specific controls.'],
                'justifications' => [
                    'Incorrect - Tactics are too high-level for specific detection rules and immediate SOC implementation',
                    'Correct - Techniques provide the optimal balance of specificity and durability for SOC detection rules, SIEM alerts, and security controls while remaining actionable for short-term defensive measures',
                    'Incorrect - Procedures are too specific and may change frequently, making them less effective for broad defensive measures',
                    'Incorrect - While all levels have value, the question asks for the most critical for short-term SOC defensive measures, where techniques provide the best actionable intelligence',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.4,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 13 - L2 - Understand
            [
                'topic' => 'TTPs',
                'subtopic' => 'Tactics, Techniques, Procedures',
                'question' => 'Which of the following BEST describes the relationship between tactics, techniques, and procedures (TTPs) in threat analysis?',
                'options' => [
                    'Tactics describe how an attack is executed, while techniques define the attacker\'s motivations and procedures reflect post-attack actions.',
                    'Tactics are the adversary\'s high-level objectives, techniques are generalized methods used to achieve them, and procedures are the specific implementations.',
                    'Tactics and procedures are used interchangeably, while techniques refer to attack vectors.',
                    'Tactics are specific tools, techniques are general strategies, and procedures are industry best practices.',
                ],
                'correct_options' => ['Tactics are the adversary\'s high-level objectives, techniques are generalized methods used to achieve them, and procedures are the specific implementations.'],
                'justifications' => [
                    'Incorrect - This reverses the definitions and mischaracterizes the scope of tactics, techniques, and procedures',
                    'Correct - This accurately describes the hierarchical relationship: tactics (high-level goals like "Initial Access"), techniques (general methods like "Phishing"), and procedures (specific implementations with exact tools and steps)',
                    'Incorrect - Tactics and procedures operate at different levels of abstraction and are not interchangeable terms',
                    'Incorrect - This completely mischaracterizes all three components; tactics are not tools, techniques are not strategies, and procedures are not best practices',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.3,
                'irt_b' => -0.1,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 14 - L1 - Remember
            [
                'topic' => 'TTPs',
                'subtopic' => 'MITRE ATT&CK Framework',
                'question' => 'In the MITRE ATT&CK framework, which of the following is the correct hierarchy?',
                'options' => [
                    'Procedure → Technique → Tactic',
                    'Tactic → Procedure → Technique',
                    'Tactic → Technique → Sub-technique',
                    'Technique → Tactic → Procedure',
                ],
                'correct_options' => ['Tactic → Technique → Sub-technique'],
                'justifications' => [
                    'Incorrect - This reverses the MITRE ATT&CK hierarchy; procedures are not explicitly defined in the framework structure',
                    'Incorrect - This incorrectly places procedures before techniques; MITRE ATT&CK does not formally include procedures in its hierarchy',
                    'Correct - MITRE ATT&CK follows a three-level hierarchy: Tactics (high-level goals like "Initial Access"), Techniques (methods like "Phishing"), and Sub-techniques (specific variants like "Spearphishing Attachment")',
                    'Incorrect - This places techniques before tactics, which reverses the logical flow from broad objectives to specific methods',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 1,
                'irt_a' => 0.8,
                'irt_b' => -1.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 15 - L1 - Remember
            [
                'topic' => 'TTPs',
                'subtopic' => 'Cyber Kill Chain',
                'question' => 'Which phase in the Cyber Kill Chain involves exploiting a vulnerability to execute malicious code on a target system?',
                'options' => [
                    'Weaponization',
                    'Delivery',
                    'Exploitation',
                    'Installation',
                ],
                'correct_options' => ['Exploitation'],
                'justifications' => [
                    'Incorrect - Weaponization involves creating the malicious payload or exploit, not executing it on the target system',
                    'Incorrect - Delivery involves transmitting the weaponized payload to the target, not executing the exploit',
                    'Correct - Exploitation is the phase where vulnerabilities are leveraged to execute malicious code on the target system',
                    'Incorrect - Installation occurs after exploitation and involves establishing persistent access or installing malware',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.8,
                'irt_b' => -1.3,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 16 - L3 - Apply
            [
                'topic' => 'TTPs',
                'subtopic' => 'TTP Attribution',
                'question' => 'What is the most effective approach for using threat intelligence to enhance your understanding of relevant TTPs?',
                'options' => [
                    'Collect all available threat intelligence regardless of relevance',
                    'Focus on intelligence about threat actors and techniques targeting your industry and geography',
                    'Only use free, publicly available threat intelligence sources',
                    'Rely exclusively on vendor-provided threat intelligence',
                ],
                'correct_options' => ['Focus on intelligence about threat actors and techniques targeting your industry and geography'],
                'justifications' => [
                    'Incorrect - This overstates the capability or scope',
                    'Correct - Focus on intelligence about threat actors and techniques targeting your industry and geography',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.6,
                'irt_b' => 0.6,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 17 - L3 - Apply
            [
                'topic' => 'TTPs',
                'subtopic' => 'Cyber Kill Chain',
                'question' => 'During an incident, forensic analysis reveals that an attacker used a spear-phishing email containing a malicious attachment. After the victim opened the attachment, a zero-day exploit was triggered, leading to the installation of a backdoor. In the context of the Cyber Kill Chain, which two stages best describe the attacker\'s actions of sending the email with the attachment and the victim opening it to trigger the exploit?',
                'options' => [
                    'Reconnaissance and Weaponization',
                    'Delivery and Exploitation',
                    'Installation and Command & Control',
                    'Action on Objectives and Exfiltration',
                ],
                'correct_options' => ['Delivery and Exploitation'],
                'justifications' => [
                    'Incorrect - Reconnaissance occurs before attack execution, and weaponization is the creation of the malicious payload, not its delivery or execution',
                    'Correct - Delivery is the spear-phishing email with malicious attachment being sent and received, while Exploitation is the zero-day exploit being triggered when the victim opened the attachment',
                    'Incorrect - Installation occurs after exploitation (the backdoor installation mentioned is a separate stage), and Command & Control happens after installation',
                    'Incorrect - These are later stages that occur after the attacker has established persistence and control over the compromised system',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 18 - L4 - Analyze
            [
                'topic' => 'TTPs',
                'subtopic' => 'MITRE ATT&CK Framework',
                'question' => 'What is the fundamental challenge in creating effective detection rules for ATT&CK techniques versus traditional malware signatures?',
                'options' => [
                    'ATT&CK techniques are simpler to detect than malware signatures',
                    'Behavioral detection requires understanding legitimate vs. malicious use of the same techniques',
                    'Malware signatures are more reliable than behavioral detection',
                    'ATT&CK techniques never produce detectable artifacts',
                ],
                'correct_options' => ['Behavioral detection requires understanding legitimate vs. malicious use of the same techniques'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Behavioral detection requires understanding legitimate vs. malicious use of the same techniques',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This is too absolute or limiting',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.8,
                'irt_b' => 1.0,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 19 - L5 - Evaluate
            [
                'topic' => 'TTPs',
                'subtopic' => 'MITRE ATT&CK Framework',
                'question' => 'A security team maps 100% of their detections to MITRE ATT&CK techniques but still experiences successful attacks. Evaluate their approach.',
                'options' => [
                    'Complete ATT&CK mapping guarantees attack prevention',
                    'Mapping is valuable but must be combined with threat modeling, gap analysis, and continuous improvement',
                    'ATT&CK mapping is irrelevant to actual security effectiveness',
                    'They should abandon ATT&CK and use a different framework',
                ],
                'correct_options' => ['Mapping is valuable but must be combined with threat modeling, gap analysis, and continuous improvement'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Mapping is valuable but must be combined with threat modeling, gap analysis, and continuous improvement',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.4,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 20 - L3 - Apply
            [
                'topic' => 'TTPs',
                'subtopic' => 'MITRE ATT&CK Framework',
                'question' => 'How should you prioritize MITRE ATT&CK techniques when developing detection rules for your organization\'s specific threat landscape?',
                'options' => [
                    'Implement detection for all ATT&CK techniques equally',
                    'Focus on techniques most commonly used by threat actors targeting your industry and assets',
                    'Only detect techniques that are easiest to implement',
                    'Prioritize techniques based on alphabetical order',
                ],
                'correct_options' => ['Focus on techniques most commonly used by threat actors targeting your industry and assets'],
                'justifications' => [
                    'Incorrect - Not all techniques pose equal risk to every organization',
                    'Correct - Risk-based prioritization focusing on relevant threat actors provides the most security value',
                    'Incorrect - Implementation ease should not override security prioritization',
                    'Incorrect - Random ordering ignores threat intelligence and risk assessment',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.5,
                'irt_b' => 0.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Topic 3: Vulnerability Management (10 questions)
            // Bloom Distribution: L1:2, L2:2, L3:3, L4:2, L5:1

            // Item 21 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'CVSS Scoring',
                'question' => 'A recent zero-day vulnerability is being actively exploited, requires no user interaction or privilege escalation, and has a significant impact to confidentiality and integrity but not to availability. Which of the following CVE metrics would be most accurate for this zero-day threat?',
                'options' => [
                    'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L',
                    'CVSS:3.1/AV:P/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:L',
                    'CVSS:3.1/AV:N/AC:L/PR:N/UI:H/S:U/C:L/I:N/A:H',
                    'CVSS:3.1/AV:L/AC:L/PR:R/UI:R/S:U/C:H/I:L/A:H',
                ],
                'correct_options' => ['CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L'],
                'justifications' => [
                    'Correct - Network vector (AV:N), Low complexity (AC:L), No privileges required (PR:N), No user interaction (UI:N), High confidentiality/integrity impact (C:H/I:H), Low availability impact (A:L)',
                    'Incorrect - Physical vector (AV:P) and High privileges required (PR:H) contradict the no privilege escalation requirement',
                    'Incorrect - High user interaction (UI:H) contradicts the no user interaction requirement, and impact ratings are inconsistent',
                    'Incorrect - Local vector (AV:L) and Required privileges (PR:R) contradict the network-based, no privilege escalation characteristics',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 4,
                'irt_a' => 1.6,
                'irt_b' => 0.5,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 22 - L1 - Remember
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Vulnerability Lifecycle',
                'question' => 'What is the correct order of the vulnerability management lifecycle?',
                'type_id' => 4, // Ordering/Drag and drop
                'options' => ['Remediation', 'Verification', 'Discovery', 'Assessment'], // Shuffled
                'correct_options' => ['Discovery', 'Assessment', 'Remediation', 'Verification'], // Correct order
                'ordering_sequence' => ['Discovery', 'Assessment', 'Remediation', 'Verification'],
                'justifications' => [
                    'Discovery - The first phase involves identifying and finding vulnerabilities through scanning, testing, or other detection methods',
                    'Assessment - The second phase evaluates discovered vulnerabilities, analyzing their severity, impact, and exploitability',
                    'Remediation - The third phase involves taking action to fix, mitigate, or address the identified vulnerabilities',
                    'Verification - The final phase confirms that remediation efforts were successful and vulnerabilities are properly addressed',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.9,
                'irt_b' => -1.2,
                'irt_c' => 0.25,
                'status' => 'published',

            ],

            // Item 23 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Vulnerability Lifecycle',
                'question' => 'Consider the following two scenarios within an organization\'s security operations:

**Scenario X:** A security analyst utilizes an automated tool to identify potential buffer overflow flaws in newly developed software code before deployment.

**Scenario Y:** After a critical security patch is applied to a server, the server is re-scanned, and logs are reviewed to confirm the vulnerability is no longer present.

Which of the following statements accurately places Scenarios X and Y within the appropriate vulnerability lifecycle phases?',
                'options' => [
                    'Scenario X is part of Remediation, while Scenario Y is part of Discovery.',
                    'Scenario X is part of Discovery, while Scenario Y is part of Verification.',
                    'Scenario X is part of Assessment, while Scenario Y is part of Remediation.',
                    'Both Scenarios X and Y are part of Discovery, but at different stages.',
                ],
                'correct_options' => ['Scenario X is part of Discovery, while Scenario Y is part of Verification.'],
                'justifications' => [
                    'Incorrect - Scenario X involves finding vulnerabilities (Discovery), not fixing them; Scenario Y occurs after remediation, not during the initial finding phase',
                    'Correct - Scenario X uses automated tools to identify/discover vulnerabilities in code, while Scenario Y confirms that applied patches successfully eliminated the vulnerability (Verification)',
                    'Incorrect - While Scenario X could involve some assessment, it primarily focuses on discovery; Scenario Y occurs after remediation is complete, not during the remediation process',
                    'Incorrect - Scenario Y involves confirming that vulnerabilities are resolved after patching, which is verification, not discovery',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 24 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Vulnerability Lifecycle',
                'question' => 'After a critical vulnerability is patched, the security team performs a scan and finds the vulnerability still reported. What is the BEST next step in the lifecycle?',
                'options' => [
                    'Rediscover the vulnerability',
                    'Document the failure',
                    'Reassess the asset value',
                    'Verify if the patch was correctly applied and effective',
                ],
                'correct_options' => ['Verify if the patch was correctly applied and effective'],
                'justifications' => [
                    'Incorrect - The vulnerability is already known; rediscovery is not needed when the issue is failed remediation',
                    'Incorrect - While documentation is important, the immediate priority is determining why the patch failed before documenting',
                    'Incorrect - Asset value reassessment is not relevant when dealing with a failed patch; the focus should be on remediation effectiveness',
                    'Correct - The verification phase should determine if the patch was properly installed, configured correctly, or if additional remediation steps are needed',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 25 - L4 - Analyze
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Vulnerability Prioritization',
                'question' => 'A critical vulnerability is discovered in a non-public-facing internal application supporting HR. The asset supports payroll operations but is segmented behind multiple layers of defense. What factor should weigh MOST in deprioritizing this vulnerability?',
                'options' => [
                    'Its classification as "critical" in NVD',
                    'The low likelihood of external exploitation',
                    'The lack of known exploits in the wild',
                    'The existence of alternative compensating controls',
                ],
                'correct_options' => ['The low likelihood of external exploitation'],
                'justifications' => [
                    'Incorrect - The critical CVSS rating indicates the severity if exploited, but does not account for the reduced attack surface due to network segmentation',
                    'Correct - Network segmentation behind multiple defense layers significantly reduces the likelihood of external exploitation, which is a key factor in risk-based prioritization despite the high impact',
                    'Incorrect - While relevant, the lack of known exploits is less significant than the architectural controls that limit attack vectors',
                    'Incorrect - The question does not indicate alternative compensating controls exist; the segmentation mentioned is network-based isolation, not alternative controls',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.7,
                'irt_b' => 0.8,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 26 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Remediation Strategies',
                'question' => 'A vulnerability was reported by a researcher, but the patch won\'t be released for 90 days. Which response BEST balances risk and operational continuity?',
                'options' => [
                    'Defer all remediation until the patch is released',
                    'Take the system offline immediately',
                    'Apply a compensating control and increase monitoring',
                    'Notify users and continue normal operation',
                ],
                'correct_options' => ['Apply a compensating control and increase monitoring'],
                'justifications' => [
                    'Incorrect - Waiting 90 days without any mitigation leaves the organization exposed to significant risk during the extended timeframe',
                    'Incorrect - Taking systems offline may be overly disruptive to operations when other risk mitigation options are available',
                    'Correct - Compensating controls (such as network segmentation, access restrictions, or additional monitoring) can reduce risk while maintaining operational continuity until the official patch is available',
                    'Incorrect - Simply notifying users without implementing any protective measures fails to adequately address the identified security risk',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.5,
                'irt_b' => 0.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 27 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Remediation Strategies',
                'question' => 'How should you establish Service Level Agreements (SLAs) for vulnerability remediation?',
                'options' => [
                    'Use the same timeframe for all vulnerabilities regardless of severity',
                    'Base SLAs on vulnerability severity, asset criticality, and business impact',
                    'Only establish SLAs for vulnerabilities with available patches',
                    'Set SLAs based on when vendors release patches',
                ],
                'correct_options' => ['Base SLAs on vulnerability severity, asset criticality, and business impact'],
                'justifications' => [
                    'Incorrect - This overstates the capability or scope',
                    'Correct - Base SLAs on vulnerability severity, asset criticality, and business impact',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.6,
                'irt_b' => 0.6,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 28 - L2 - Understand
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Asset Inventory',
                'question' => 'Why is incomplete asset inventory a critical vulnerability?',
                'options' => [
                    'It lowers the severity of findings',
                    'It reduces bandwidth during scans',
                    'It leads to risk blind spots and unmanaged exposures',
                    'It prevents threat intelligence from being consumed',
                ],
                'correct_options' => ['It leads to risk blind spots and unmanaged exposures'],
                'justifications' => [
                    'Incorrect - Incomplete asset inventory does not affect the severity ratings of vulnerabilities that are discovered',
                    'Incorrect - Bandwidth usage is not the primary concern with incomplete asset inventory; the issue is coverage, not performance',
                    'Correct - Assets not included in inventory cannot be scanned, monitored, or managed, creating security blind spots where vulnerabilities remain unknown and unaddressed',
                    'Incorrect - Asset inventory completeness does not directly impact the ability to consume threat intelligence feeds',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.2,
                'irt_b' => -0.5,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 29 - L4 - Analyze
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Vulnerability Lifecycle',
                'question' => 'What is the fundamental challenge in measuring the effectiveness of vulnerability management programs?',
                'options' => [
                    'Vulnerability counts are the only reliable metric',
                    'Balancing metrics like time-to-remediation with actual risk reduction and business impact',
                    'Effectiveness cannot be measured in vulnerability management',
                    'Only technical metrics matter for vulnerability management',
                ],
                'correct_options' => ['Balancing metrics like time-to-remediation with actual risk reduction and business impact'],
                'justifications' => [
                    'Incorrect - This is too absolute or limiting',
                    'Correct - Balancing metrics like time-to-remediation with actual risk reduction and business impact',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This is too absolute or limiting',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.8,
                'irt_b' => 1.0,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 30 - L5 - Evaluate
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Remediation Strategies',
                'question' => 'A organization boasts a 99% patch compliance rate but still experiences successful attacks through unpatched systems. Evaluate their vulnerability management approach.',
                'options' => [
                    'High patch compliance guarantees security effectiveness',
                    'Compliance metrics may mask gaps in coverage, prioritization, or non-patchable vulnerabilities',
                    'The organization should abandon vulnerability management',
                    'Attacks are unrelated to vulnerability management effectiveness',
                ],
                'correct_options' => ['Compliance metrics may mask gaps in coverage, prioritization, or non-patchable vulnerabilities'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Compliance metrics may mask gaps in coverage, prioritization, or non-patchable vulnerabilities',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.5,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Topic 4: Vulnerability Assessment (10 questions)
            // Bloom Distribution: L1:2, L2:2, L3:3, L4:2, L5:1

            // Item 31 - L1 - Remember
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Vulnerability Prioritization',
                'question' => 'What is the difference between authenticated and unauthenticated vulnerability scans?',
                'options' => [
                    'Authenticated scans require user interaction while unauthenticated scans are automated',
                    'Authenticated scans use system credentials to access internal configurations',
                    'Unauthenticated scans are more thorough than authenticated scans',
                    'There is no difference between the two scan types',
                ],
                'correct_options' => ['Authenticated scans use system credentials to access internal configurations'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Authenticated scans use system credentials to access internal configurations',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.8,
                'irt_b' => -1.3,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 32 - L2 - Understand
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Scanning Errors',
                'question' => 'A security analyst uses an automated vulnerability scanner. It regularly updates with the latest vulnerability feeds. If the system regularly performs active scans and returns the presence of vulnerabilities when they do not exist, what type of error is the system most likely making?',
                'options' => [
                    'False positive',
                    'False negative',
                    'True positive',
                    'True negative',
                ],
                'correct_options' => ['False positive'],
                'justifications' => [
                    'Correct - A false positive occurs when a scanner reports vulnerabilities that do not actually exist on the system',
                    'Incorrect - A false negative would be when vulnerabilities exist but are not detected by the scanner',
                    'Incorrect - A true positive would be when the scanner correctly identifies vulnerabilities that actually exist',
                    'Incorrect - A true negative would be when the scanner correctly reports no vulnerabilities when none exist',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 2,
                'irt_a' => 1.1,
                'irt_b' => -0.8,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 33 - L2 - Understand
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'CVSS Scoring',
                'question' => 'Why might network-based vulnerability scans miss certain types of vulnerabilities?',
                'options' => [
                    'Network scans are always comprehensive and miss nothing',
                    'They cannot assess host-based configurations, local privileges, or application-specific vulnerabilities',
                    'Network scans only work on Windows systems',
                    'They are too slow to detect modern vulnerabilities',
                ],
                'correct_options' => ['They cannot assess host-based configurations, local privileges, or application-specific vulnerabilities'],
                'justifications' => [
                    'Incorrect - This is too absolute or limiting',
                    'Correct - They cannot assess host-based configurations, local privileges, or application-specific vulnerabilities',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.2,
                'irt_b' => -0.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 34 - L2 - Understand
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Risk-Based Ranking',
                'question' => 'How does dynamic application security testing (DAST) complement static code analysis?',
                'options' => [
                    'DAST and static analysis are identical testing methods',
                    'DAST tests running applications while static analysis examines source code',
                    'Static analysis is always more accurate than DAST',
                    'DAST only works on web applications while static analysis works on all software',
                ],
                'correct_options' => ['DAST tests running applications while static analysis examines source code'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - DAST tests running applications while static analysis examines source code',
                    'Incorrect - This is too absolute or limiting',
                    'Incorrect - This is too absolute or limiting',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.3,
                'irt_b' => -0.1,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 35 - L3 - Apply
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Vulnerability Prioritization',
                'question' => 'When planning vulnerability assessments for a network with critical production systems, what approach minimizes business disruption?',
                'options' => [
                    'Run all scans during peak business hours for realistic results',
                    'Schedule authenticated scans during maintenance windows and use non-intrusive scanning techniques',
                    'Skip vulnerability assessments on critical systems',
                    'Only perform unauthenticated scans regardless of thoroughness',
                ],
                'correct_options' => ['Schedule authenticated scans during maintenance windows and use non-intrusive scanning techniques'],
                'justifications' => [
                    'Incorrect - This overstates the capability or scope',
                    'Correct - Schedule authenticated scans during maintenance windows and use non-intrusive scanning techniques',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This is too absolute or limiting',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 36 - L2 - Understand
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'CVE, CWE, NVD Systems',
                'question' => 'Which of the following BEST distinguishes a CWE from a CVE?',
                'options' => [
                    'CWE represents a specific instance of vulnerability; CVE is a broader category',
                    'CWE is a vulnerability scoring system; CVE is for tracking incidents',
                    'CVE tracks specific disclosed vulnerabilities; CWE describes the underlying weakness class',
                    'CVE is part of the MITRE ATT&CK; CWE is part of CVSS',
                ],
                'correct_options' => ['CVE tracks specific disclosed vulnerabilities; CWE describes the underlying weakness class'],
                'justifications' => [
                    'Incorrect - This reverses the relationship; CVE is for specific instances while CWE represents broader categories',
                    'Incorrect - CWE is not a scoring system, and CVE is not for incident tracking but vulnerability disclosure',
                    'Correct - CVE (Common Vulnerabilities and Exposures) assigns unique identifiers to specific disclosed vulnerabilities, while CWE (Common Weakness Enumeration) categorizes types of software weaknesses',
                    'Incorrect - Neither CVE nor CWE are part of MITRE ATT&CK or CVSS; they are separate vulnerability classification systems',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.3,
                'irt_b' => -0.1,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 37 - L3 - Apply
            [
                'topic' => 'Vulnerability Management',
                'subtopic' => 'Patch Management',
                'question' => 'What is the BEST method to validate the effectiveness of an enterprise\'s patching program?',
                'options' => [
                    'Carry out vulnerability scans',
                    'Perform penetration testing',
                    'Review patch management policy',
                    'Check vendor patch release notes',
                ],
                'correct_options' => ['Carry out vulnerability scans'],
                'justifications' => [
                    'Correct - Vulnerability scans provide direct validation by identifying whether known vulnerabilities remain after patching',
                    'Incorrect - While penetration testing can validate security, it is less specific to patch effectiveness than vulnerability scanning',
                    'Incorrect - Policy review ensures procedures exist but does not validate actual patch deployment effectiveness',
                    'Incorrect - Vendor notes provide patch information but do not validate whether patches were successfully applied',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 38 - L2 - Understand
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Zero-Day vs N-Day',
                'question' => 'Which scenario BEST illustrates a zero-day vulnerability?',
                'options' => [
                    'A critical buffer overflow in OpenSSL patched by vendors last week',
                    'A misconfiguration in a firewall rule exploited after publication',
                    'A logic flaw exploited in the wild before public disclosure or patch availability',
                    'A known CVE that remains unpatched due to delayed updates',
                ],
                'correct_options' => ['A logic flaw exploited in the wild before public disclosure or patch availability'],
                'justifications' => [
                    'Incorrect - This describes a recently patched vulnerability, not a zero-day which by definition has no available patch',
                    'Incorrect - Misconfigurations are not vulnerabilities in the software itself, and this implies the issue was already known',
                    'Correct - Zero-day vulnerabilities are unknown to vendors and the public, with no available patches, yet are being actively exploited',
                    'Incorrect - A known CVE indicates the vulnerability has been publicly disclosed, making it no longer a zero-day',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.2,
                'irt_b' => -0.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 39 - L4 - Analyze
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'Zero-Day vs N-Day',
                'question' => 'What is the fundamental limitation of signature-based vulnerability detection in rapidly evolving threat landscapes?',
                'options' => [
                    'Signature-based detection is always perfect',
                    'May miss zero-day vulnerabilities and novel attack techniques not in signature databases',
                    'Signatures are too complex for most organizations to use',
                    'Signature-based detection only works on legacy systems',
                ],
                'correct_options' => ['May miss zero-day vulnerabilities and novel attack techniques not in signature databases'],
                'justifications' => [
                    'Incorrect - This is too absolute or limiting',
                    'Correct - May miss zero-day vulnerabilities and novel attack techniques not in signature databases',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This is too absolute or limiting',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.8,
                'irt_b' => 1.0,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 40 - L4 - Analyze
            [
                'topic' => 'Vulnerability Assessment',
                'subtopic' => 'CVE, CWE, NVD Systems',
                'question' => 'A security team is tasked with building a robust threat intelligence capability. They want to systematically track and understand newly disclosed vulnerabilities and their potential impact, as well as identify recurring software development flaws that contribute to these vulnerabilities. Which combination of standardized systems would be most effective for achieving both these objectives, and why?',
                'options' => [
                    'CVE and CVSS, because they provide unique IDs and severity scores.',
                    'NVD and CPE, because NVD contains detailed info and CPE identifies products.',
                    'CVE and CWE, because CVE tracks specific instances of vulnerabilities, while CWE categorizes the underlying weakness types.',
                    'NVD and MITRE ATT&CK, because NVD provides vulnerability details and ATT&CK covers adversary behaviors.',
                ],
                'correct_options' => ['CVE and CWE, because CVE tracks specific instances of vulnerabilities, while CWE categorizes the underlying weakness types.'],
                'justifications' => [
                    'Incorrect - While CVE and CVSS are useful, CVSS only provides severity scoring and does not help identify recurring development flaws',
                    'Incorrect - CPE identifies products but does not categorize the types of weaknesses that lead to vulnerabilities',
                    'Correct - CVE provides systematic tracking of specific disclosed vulnerabilities, while CWE categorizes the underlying weakness types, enabling pattern analysis for recurring development flaws',
                    'Incorrect - MITRE ATT&CK focuses on adversary tactics and techniques, not on categorizing the software weaknesses that create vulnerabilities',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.7,
                'irt_b' => 0.8,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Topic 5: Malware (10 questions)
            // Bloom Distribution: L1:2, L2:2, L3:3, L4:2, L5:1

            // Item 41 - L1 - Remember
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Types',
                'question' => 'What is ransomware?',
                'options' => [
                    'Software that monitors user activity',
                    'Malware that encrypts files and demands payment for decryption',
                    'A legitimate data backup solution',
                    'Software that removes viruses from systems',
                ],
                'correct_options' => ['Malware that encrypts files and demands payment for decryption'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Malware that encrypts files and demands payment for decryption',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.8,
                'irt_b' => -1.5,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 42 - L1 - Remember
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Types',
                'question' => 'What is a trojan horse in cybersecurity?',
                'options' => [
                    'A network security appliance',
                    'Malware disguised as legitimate software',
                    'A type of firewall configuration',
                    'A secure communication protocol',
                ],
                'correct_options' => ['Malware disguised as legitimate software'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Malware disguised as legitimate software',
                    'Incorrect - This overstates the capability or scope',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.9,
                'irt_b' => -1.3,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 43 - L3 - Apply
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Types',
                'question' => 'Consider two malware samples:

**Sample A:** Spreads by exploiting a vulnerability in network protocols, automatically infecting other machines without user interaction, and consumes significant network bandwidth.

**Sample B:** Masquerades as a legitimate system utility. When executed by a user, it secretly opens a backdoor, allowing remote access, but does not self-replicate.

How do Sample A and Sample B primarily differ in their classification and core propagation mechanism?',
                'options' => [
                    'Sample A is a Trojan due to network spread, while Sample B is a Worm because it creates a backdoor.',
                    'Sample A is a Worm due to self-propagation, while Sample B is a Trojan due to deceptive appearance and lack of self-replication.',
                    'Both Sample A and Sample B are Viruses, but with different infection vectors.',
                    'Sample A is a Rootkit because it exploits vulnerabilities, while Sample B is Spyware because it allows remote access.',
                ],
                'correct_options' => ['Sample A is a Worm due to self-propagation, while Sample B is a Trojan due to deceptive appearance and lack of self-replication.'],
                'justifications' => [
                    'Incorrect - This reverses the malware classifications; network spread with self-propagation defines worms, not trojans',
                    'Correct - Sample A exhibits worm characteristics (self-propagation via network exploitation without user interaction), while Sample B shows trojan behavior (deceptive appearance, requires user execution, no self-replication)',
                    'Incorrect - Viruses require a host file and typically spread through file sharing, which neither sample demonstrates',
                    'Incorrect - Rootkits focus on hiding presence, and spyware focuses on data collection, which are not the primary characteristics described',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 44 - L4 - Analyze
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Types',
                'question' => 'A security analyst observes a new piece of malware that, once executed, inserts itself deeply into the operating system kernel, making its presence extremely difficult to detect by traditional antivirus software. It then begins silently collecting user keystrokes and browser history, sending them to a remote server. Which combination of malware types best describes this sophisticated threat, and why is it particularly challenging to mitigate?',
                'options' => [
                    'Worm and Adware; challenging because of its rapid spread and annoying pop-ups.',
                    'Trojan and Ransomware; challenging due to its deceptive nature and data encryption capabilities.',
                    'Rootkit and Spyware; challenging because the rootkit component hides the spyware\'s activities from detection, making persistent data exfiltration highly stealthy.',
                    'Virus and Trojan; challenging due to its ability to infect files and masquerade as legitimate software.',
                ],
                'correct_options' => ['Rootkit and Spyware; challenging because the rootkit component hides the spyware\'s activities from detection, making persistent data exfiltration highly stealthy.'],
                'justifications' => [
                    'Incorrect - The malware does not spread automatically (no worm behavior) nor display advertisements (no adware characteristics)',
                    'Incorrect - No indication of deceptive installation (trojan) or file encryption for ransom (ransomware); the focus is stealth and data collection',
                    'Correct - The deep kernel insertion and detection evasion indicate rootkit functionality, while keystroke and browser history collection represent spyware behavior; the combination makes detection and removal extremely difficult',
                    'Incorrect - No file infection behavior (virus) or deceptive installation method (trojan); the primary characteristics are stealth and surveillance',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.4,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 45 - L3 - Apply
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Behavior',
                'question' => 'Your organization detects suspicious PowerShell activity and WMI usage without corresponding executable files. What type of attack does this suggest?',
                'options' => [
                    'Traditional virus infection',
                    'Fileless malware attack using living-off-the-land techniques',
                    'Physical security breach',
                    'Network configuration error',
                ],
                'correct_options' => ['Fileless malware attack using living-off-the-land techniques'],
                'justifications' => [
                    'Incorrect - This option does not accurately describe the concept',
                    'Correct - Fileless malware attack using living-off-the-land techniques',
                    'Incorrect - This option does not accurately describe the concept',
                    'Incorrect - This option does not accurately describe the concept',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 46 - L4 - Analyze
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Types',
                'question' => 'A rootkit has been detected on a critical production server. The rootkit has compromised the kernel, providing stealth access and bypassing antivirus detection. What is the BEST course of action to ensure the system\'s integrity and security moving forward?',
                'options' => [
                    'Run a full antivirus scan using updated signatures from a live CD environment.',
                    'Attempt manual removal of the rootkit using known disinfection scripts.',
                    'Format the system drive and perform a clean operating system reinstallation from trusted media.',
                    'Isolate the system, patch the OS, and reintroduce it to the network with enhanced monitoring.',
                ],
                'correct_options' => ['Format the system drive and perform a clean operating system reinstallation from trusted media.'],
                'justifications' => [
                    'Incorrect - Rootkits operating at kernel level can evade detection even from live CD environments and may not be fully removable by antivirus software',
                    'Incorrect - Manual removal scripts may miss rootkit components or fail against sophisticated kernel-level infections, leaving the system compromised',
                    'Correct - Complete system wipe and reinstallation is the only way to guarantee removal of kernel-level rootkits and restore system integrity, as they can hide deep within the OS and resist other removal methods',
                    'Incorrect - Patching alone cannot remove existing rootkit infections; the compromised kernel remains untrustworthy even with patches and monitoring',
                ],
                'bloom_level' => 4,
                'difficulty_level' => 4,
                'irt_a' => 1.7,
                'irt_b' => 0.8,
                'irt_c' => 0.20,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 47 - L1 - Remember
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Indicators',
                'question' => 'How often should antivirus signature files be updated to maintain effective protection?',
                'options' => [
                    'Once a week',
                    'Once a month',
                    'Only when new viruses are reported',
                    'Daily or in real-time, as updates become available',
                ],
                'correct_options' => ['Daily or in real-time, as updates become available'],
                'justifications' => [
                    'Incorrect - Weekly updates leave systems vulnerable to new threats discovered between update cycles',
                    'Incorrect - Monthly updates provide inadequate protection given the rapid pace of new malware creation',
                    'Incorrect - Waiting for virus reports creates dangerous gaps in protection as threats may already be circulating',
                    'Correct - Daily or real-time updates provide the most current protection against newly discovered threats, as malware variants are created continuously and signatures must be updated frequently',
                ],
                'bloom_level' => 1,
                'difficulty_level' => 1,
                'irt_a' => 0.8,
                'irt_b' => -1.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 48 - L2 - Understand
            [
                'topic' => 'Malware',
                'subtopic' => 'Analysis Techniques',
                'question' => 'What is the MAIN concern with anomaly-based antivirus detection systems?',
                'options' => [
                    'They cannot detect unknown threats',
                    'They are ineffective against signature-based attacks',
                    'They may generate a high number of false positives',
                    'They require frequent manual updates',
                ],
                'correct_options' => ['They may generate a high number of false positives'],
                'justifications' => [
                    'Incorrect - Anomaly-based systems are specifically designed to detect unknown or previously unseen threats by identifying deviations from normal behavior',
                    'Incorrect - Signature-based attacks are typically caught by signature-based systems, but anomaly detection can still flag them based on behavioral patterns',
                    'Correct - Since anomaly-based detection looks for deviations from baseline behavior, it may flag legitimate activity as malicious if it slightly deviates from what is considered "normal," leading to high false positive rates',
                    'Incorrect - Unlike signature-based systems, anomaly-based systems do not rely heavily on manual signature updates but on behavioral baselines and machine learning models',
                ],
                'bloom_level' => 2,
                'difficulty_level' => 3,
                'irt_a' => 1.2,
                'irt_b' => -0.4,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 49 - L3 - Apply
            [
                'topic' => 'Malware',
                'subtopic' => 'Analysis Techniques',
                'question' => 'Consider two malware analysis techniques:

**Technique X:** Executing a suspicious binary in an isolated virtual environment to observe its interactions with the operating system, network traffic, and file system modifications.

**Technique Y:** Disassembling a malware sample to examine its assembly code, identify API calls, and extract embedded strings without execution.

How do Technique X and Technique Y primarily differ in their approach and the type of information they reveal?',
                'options' => [
                    'Technique X reveals static properties, while Technique Y reveals runtime behavior.',
                    'Technique X is dynamic analysis, revealing runtime behavior; Technique Y is static analysis, revealing structural properties and potential functionalities.',
                    'Technique X is primarily for network analysis, while Technique Y is for host-based forensics.',
                    'Both techniques are forms of dynamic analysis, but at different levels of isolation.',
                ],
                'correct_options' => ['Technique X is dynamic analysis, revealing runtime behavior; Technique Y is static analysis, revealing structural properties and potential functionalities.'],
                'justifications' => [
                    'Incorrect - This reverses the analysis types; executing malware reveals runtime behavior (dynamic), while disassembly reveals static properties',
                    'Correct - Technique X (execution in virtual environment) is dynamic analysis that reveals actual runtime behavior, while Technique Y (disassembly without execution) is static analysis that reveals code structure and potential capabilities',
                    'Incorrect - Both techniques can provide network and host information; the distinction is between dynamic execution vs. static examination',
                    'Incorrect - Technique Y (disassembly) does not involve execution at all, making it static analysis, not dynamic analysis',
                ],
                'bloom_level' => 3,
                'difficulty_level' => 3,
                'irt_a' => 1.4,
                'irt_b' => 0.2,
                'irt_c' => 0.25,
                'status' => 'published',
                'type_id' => 1,

            ],

            // Item 50 - L5 - Evaluate
            [
                'topic' => 'Malware',
                'subtopic' => 'Malware Indicators',
                'question' => 'An organization\'s primary defense against malware consists solely of a cloud-based antivirus solution with real-time scanning. Despite this, it continues to face recurring malware infections. What is the most likely explanation for the persistence of these threats, given modern threat landscapes?',
                'options' => [
                    'Cloud-based antivirus is inherently less effective than traditional on-premises solutions, leading to coverage gaps.',
                    'Malware infections are inevitable in a connected world, and security controls have limited preventative value.',
                    'Relying on a single security layer introduces gaps that only a defense-in-depth approach can mitigate.',
                    'High false-positive rates in real-time scanning cause alerts to be ignored, allowing malware to persist undetected.',
                ],
                'correct_options' => ['Relying on a single security layer introduces gaps that only a defense-in-depth approach can mitigate.'],
                'justifications' => [
                    'Incorrect - Cloud-based antivirus can be as effective as on-premises solutions; the deployment model is not the primary issue',
                    'Incorrect - While threats are prevalent, this fatalistic view ignores the effectiveness of properly layered security controls',
                    'Correct - Single-layer protection, regardless of quality, cannot address all attack vectors; modern threats require multiple complementary security controls including endpoint protection, network monitoring, email filtering, user training, and behavioral analysis',
                    'Incorrect - While false positives can be problematic, the scenario describes recurring infections, not ignored alerts; the core issue is insufficient coverage depth',
                ],
                'bloom_level' => 5,
                'difficulty_level' => 5,
                'irt_a' => 1.9,
                'irt_b' => 1.5,
                'irt_c' => 0.15,
                'status' => 'published',
                'type_id' => 1,

            ],
        ];
    }
}
