<?php

namespace Database\Seeders\Diagnostics;

use App\Models\DiagnosticItem;
use App\Models\DiagnosticTopic;


use Illuminate\Database\Seeder;

class D7ThreatVulnerabilityManagementSeeder extends Seeder
{
    public function run(): void
    {
        // Get reference data
        $topics = DiagnosticTopic::whereHas('domain', function($query) {
            $query->where('name', 'Threat & Vulnerability Management');
        })->pluck('id', 'name');
        
        
        $items = [
            // Threats & Threat Actors - Item 1
            [
                'topic_id' => $topics['Threats & Threat Actors'] ?? 123,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which threat actor is typically the most sophisticated and well-resourced?',
                'options' => [
                    'Script kiddies',
                    'Hacktivists',
                    'Nation-state actors',
                    'Insider threats'
                ],
                'correct_options' => ['Nation-state actors'],
                'justifications' => [
                    'Script kiddies use existing tools with limited skills',
                    'Hacktivists vary in sophistication but lack state resources',
                    'Correct - Nation-states have extensive resources, advanced tools, and long-term objectives',
                    'Insiders have access but not necessarily sophisticated tools'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // Threat Actors Motivation - Item 2
            [
                'topic_id' => $topics['Threats & Threat Actors'] ?? 123,
                'type_id' => 5,
                'dimension' => 'Technical',
                'content' => 'Match each threat actor with their primary motivation:',
                'options' => [
                    'items' => [
                        'Cybercriminals',
                        'Hacktivists',
                        'Nation-state actors',
                        'Insider threats'
                    ],
                    'targets' => [
                        'Financial gain',
                        'Political/ideological goals',
                        'Espionage/strategic advantage',
                        'Revenge/personal gain'
                    ]
                ],
                'correct_options' => [
                    'Cybercriminals' => 'Financial gain',
                    'Hacktivists' => 'Political/ideological goals',
                    'Nation-state actors' => 'Espionage/strategic advantage',
                    'Insider threats' => 'Revenge/personal gain'
                ],
                'justifications' => [
                    'Cybercriminals' => 'Motivated by monetary profit through ransomware, theft, fraud',
                    'Hacktivists' => 'Driven by causes, activism, and ideological beliefs',
                    'Nation-state actors' => 'Seek intelligence, IP theft, and geopolitical advantages',
                    'Insider threats' => 'Often motivated by grievances, financial pressure, or personal benefit'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Threat Vectors - Item 3
            [
                'topic_id' => $topics['Threat Vectors'] ?? 124,
                'type_id' => 3,
                'dimension' => 'Technical',
                'content' => 'Select common threat vectors used in modern cyberattacks:',
                'options' => [
                    'Phishing emails',
                    'Carrier pigeons',
                    'Compromised websites',
                    'Smoke signals',
                    'USB devices',
                    'Telegraph messages'
                ],
                'correct_options' => ['Phishing emails', 'Compromised websites', 'USB devices'],
                'justifications' => [
                    'Email remains the top initial attack vector',
                    'Outdated communication method',
                    'Watering hole and drive-by download attacks',
                    'Not a digital threat vector',
                    'Physical media attacks still common',
                    'Obsolete technology'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // Attack Surface - Item 4
            [
                'topic_id' => $topics['Attack Surface & Enumeration'] ?? 125,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What does "attack surface" refer to in cybersecurity?',
                'options' => [
                    'Physical area of the data center',
                    'Total sum of vulnerabilities exposed to potential attackers',
                    'Size of the IT security team',
                    'Number of firewalls deployed'
                ],
                'correct_options' => ['Total sum of vulnerabilities exposed to potential attackers'],
                'justifications' => [
                    'Attack surface is logical, not physical space',
                    'Correct - Encompasses all points where an attacker could try to enter or extract data',
                    'Team size doesn\'t define attack surface',
                    'Firewalls reduce but don\'t define attack surface'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Malware Families - Item 5
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which type of malware encrypts files and demands payment for decryption?',
                'options' => [
                    'Virus',
                    'Worm',
                    'Ransomware',
                    'Adware'
                ],
                'correct_options' => ['Ransomware'],
                'justifications' => [
                    'Viruses replicate but don\'t typically encrypt for ransom',
                    'Worms spread across networks but don\'t demand ransom',
                    'Correct - Ransomware specifically encrypts data and demands payment',
                    'Adware displays advertisements, doesn\'t encrypt'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // Malware Characteristics - Item 6
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What distinguishes a worm from a virus?',
                'options' => [
                    'Worms are more destructive',
                    'Worms self-replicate without user interaction',
                    'Viruses only affect Linux systems',
                    'Worms cannot spread over networks'
                ],
                'correct_options' => ['Worms self-replicate without user interaction'],
                'justifications' => [
                    'Destructiveness varies by specific malware',
                    'Correct - Worms spread automatically while viruses need host program execution',
                    'Viruses affect all operating systems',
                    'Worms specifically spread via networks'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Threat Indicators - Item 9
            [
                'topic_id' => $topics['Threat Indicators'] ?? 129,
                'type_id' => 3,
                'dimension' => 'Technical',
                'content' => 'Identify examples of Indicators of Compromise (IOCs):',
                'options' => [
                    'Malicious IP addresses',
                    'Company mission statement',
                    'File hashes of malware',
                    'Employee birthday list',
                    'Suspicious domain names',
                    'Cafeteria schedule'
                ],
                'correct_options' => ['Malicious IP addresses', 'File hashes of malware', 'Suspicious domain names'],
                'justifications' => [
                    'IPs used in attacks are classic IOCs',
                    'Mission statements aren\'t security indicators',
                    'Hash values identify known malware',
                    'Birthdays aren\'t compromise indicators',
                    'Malicious domains indicate compromise',
                    'Meal schedules are irrelevant to security'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 3,
                'status' => 'published'
            ],
            
            // IOA vs IOC - Item 10
            [
                'topic_id' => $topics['Threat Indicators'] ?? 129,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What is the key difference between Indicators of Attack (IOA) and Indicators of Compromise (IOC)?',
                'options' => [
                    'IOAs are more accurate than IOCs',
                    'IOAs detect active attacks; IOCs show past compromise',
                    'IOCs are only for malware; IOAs for all threats',
                    'There is no difference'
                ],
                'correct_options' => ['IOAs detect active attacks; IOCs show past compromise'],
                'justifications' => [
                    'Accuracy depends on implementation',
                    'Correct - IOAs identify attack behaviors in progress; IOCs are forensic evidence',
                    'Both can apply to various threat types',
                    'Significant differences exist'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Vulnerability Management Lifecycle - Item 11
            [
                'topic_id' => $topics['Vulnerability Management Lifecycle'] ?? 130,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What is the first step in the vulnerability management lifecycle?',
                'options' => [
                    'Patch deployment',
                    'Risk assessment',
                    'Asset discovery',
                    'Reporting'
                ],
                'correct_options' => ['Asset discovery'],
                'justifications' => [
                    'Cannot patch what you haven\'t found',
                    'Need to know assets before assessing risk',
                    'Correct - Must identify all assets before scanning for vulnerabilities',
                    'Reporting comes at the end'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // CVE System - Item 12
            [
                'topic_id' => $topics['Common Vulnerabilities & Exposures (CVE)'] ?? 131,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What does a CVE identifier uniquely represent?',
                'options' => [
                    'A specific software product',
                    'A publicly disclosed cybersecurity vulnerability',
                    'A security patch',
                    'A threat actor group'
                ],
                'correct_options' => ['A publicly disclosed cybersecurity vulnerability'],
                'justifications' => [
                    'Products may have multiple CVEs',
                    'Correct - Each CVE represents a specific, publicly known vulnerability',
                    'Patches fix CVEs but aren\'t CVEs themselves',
                    'Threat actors aren\'t tracked by CVE'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // CVSS Scoring - Item 13
            [
                'topic_id' => $topics['Common Vulnerability Scoring System (CVSS)'] ?? 132,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'A vulnerability with a CVSS score of 9.8 would be classified as:',
                'options' => [
                    'Low',
                    'Medium',
                    'High',
                    'Critical'
                ],
                'correct_options' => ['Critical'],
                'justifications' => [
                    'Low is 0.1-3.9',
                    'Medium is 4.0-6.9',
                    'High is 7.0-8.9',
                    'Correct - Critical is 9.0-10.0, requiring immediate attention'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 3,
                'status' => 'published'
            ],
            
            
            // CWE Classification - Item 15
            [
                'topic_id' => $topics['Common Weakness Enumeration (CWE)'] ?? 133,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'How does CWE differ from CVE?',
                'options' => [
                    'CWE describes vulnerability types; CVE identifies specific instances',
                    'They are the same thing with different names',
                    'CVE is for hardware; CWE for software',
                    'CWE is newer than CVE'
                ],
                'correct_options' => ['CWE describes vulnerability types; CVE identifies specific instances'],
                'justifications' => [
                    'Correct - CWE catalogs weakness types (e.g., SQL injection), CVE tracks specific vulnerabilities',
                    'They serve different purposes',
                    'Both apply to software and hardware',
                    'Age doesn\'t define their difference'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Zero-Day Market - Item 18
            [
                'topic_id' => $topics['Zero-Day Vulnerabilities'] ?? 135,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Why are zero-day vulnerabilities particularly valuable to attackers?',
                'options' => [
                    'They are easier to exploit',
                    'No patches or signatures exist to detect them',
                    'They only affect old systems',
                    'They are well-documented'
                ],
                'correct_options' => ['No patches or signatures exist to detect them'],
                'justifications' => [
                    'Complexity varies by vulnerability',
                    'Correct - Unknown vulnerabilities bypass security controls and detection',
                    'Zero-days often affect current systems',
                    'By definition, they\'re not publicly documented'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            
            // System Hardening - Item 20
            [
                'topic_id' => $topics['System & Application Hardening'] ?? 137,
                'type_id' => 3,
                'dimension' => 'Technical',
                'content' => 'Select effective system hardening techniques:',
                'options' => [
                    'Disable unnecessary services',
                    'Use default passwords',
                    'Remove unused software',
                    'Enable all features',
                    'Apply security baselines',
                    'Grant admin rights to all'
                ],
                'correct_options' => ['Disable unnecessary services', 'Remove unused software', 'Apply security baselines'],
                'justifications' => [
                    'Reduces attack surface',
                    'Default passwords are major vulnerability',
                    'Less software means fewer vulnerabilities',
                    'Should disable unnecessary features',
                    'Baselines ensure consistent security',
                    'Violates least privilege principle'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 3,
                'status' => 'published'
            ],
            
            
            // Threat Intelligence - Item 22
            [
                'topic_id' => $topics['Threat Indicators'] ?? 129,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which type of threat intelligence is most actionable for security operations?',
                'options' => [
                    'Strategic intelligence',
                    'Tactical intelligence',
                    'Operational intelligence',
                    'Weather intelligence'
                ],
                'correct_options' => ['Tactical intelligence'],
                'justifications' => [
                    'Strategic is high-level for executives',
                    'Correct - Tactical provides specific IOCs and TTPs for immediate use',
                    'Operational covers adversary capabilities',
                    'Weather isn\'t threat intelligence'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 5,
                'status' => 'published'
            ],
            
            // Kill Chain Defense - Item 23
            [
                'topic_id' => $topics['Cyber Kill Chain'] ?? 128,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'At which stage of the Cyber Kill Chain is it most cost-effective to stop an attack?',
                'options' => [
                    'Actions on Objectives',
                    'Early stages (Reconnaissance/Weaponization)',
                    'Command and Control',
                    'It doesn\'t matter when'
                ],
                'correct_options' => ['Early stages (Reconnaissance/Weaponization)'],
                'justifications' => [
                    'Damage already done at this stage',
                    'Correct - Earlier detection prevents damage and is less costly to remediate',
                    'Attack is well-established by C2 phase',
                    'Earlier intervention is always better'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 5,
                'status' => 'published'
            ],
            
            // Rootkit Detection - Item 24
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Why are rootkits particularly difficult to detect and remove?',
                'options' => [
                    'They use strong encryption',
                    'They hide at the kernel level or below',
                    'They only run at night',
                    'They delete themselves quickly'
                ],
                'correct_options' => ['They hide at the kernel level or below'],
                'justifications' => [
                    'Encryption doesn\'t affect detection difficulty',
                    'Correct - Rootkits operate at low levels, hiding from normal detection methods',
                    'Malware timing doesn\'t affect detection',
                    'Persistence is their goal, not deletion'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Supply Chain Attacks - Item 25
            [
                'topic_id' => $topics['Threat Vectors'] ?? 124,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'In a supply chain attack, attackers typically target:',
                'options' => [
                    'Only the final target organization',
                    'Weaker third-party vendors to reach final targets',
                    'Physical supply trucks',
                    'Only government agencies'
                ],
                'correct_options' => ['Weaker third-party vendors to reach final targets'],
                'justifications' => [
                    'Supply chain attacks are indirect',
                    'Correct - Attackers compromise trusted vendors to access better-protected targets',
                    'Refers to software/service supply chain',
                    'All sectors can be targeted'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Vulnerability Prioritization - Item 26
            [
                'topic_id' => $topics['Vulnerability Management Lifecycle'] ?? 130,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Beyond CVSS scores, what factor is most important in prioritizing vulnerability remediation?',
                'options' => [
                    'Age of the vulnerability',
                    'Exploitability and business context',
                    'Vendor reputation',
                    'Media coverage'
                ],
                'correct_options' => ['Exploitability and business context'],
                'justifications' => [
                    'Old vulnerabilities can still be critical',
                    'Correct - Real-world exploitability and impact to specific business assets matter most',
                    'Vendor doesn\'t determine criticality',
                    'Media attention doesn\'t equal risk'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 5,
                'status' => 'published'
            ],
            
            // Threat Hunting - Item 27
            [
                'topic_id' => $topics['Threat Indicators'] ?? 129,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'How does threat hunting differ from traditional security monitoring?',
                'options' => [
                    'It\'s completely automated',
                    'It proactively searches for hidden threats',
                    'It only responds to alerts',
                    'It requires no special skills'
                ],
                'correct_options' => ['It proactively searches for hidden threats'],
                'justifications' => [
                    'Threat hunting requires human analysis',
                    'Correct - Hunting actively seeks threats that evade automated detection',
                    'That\'s reactive monitoring, not hunting',
                    'Requires advanced analytical skills'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Living off the Land - Item 28
            [
                'topic_id' => $topics['MITRE ATT&CK Framework'] ?? 127,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What does "Living off the Land" (LotL) mean in the context of cyberattacks?',
                'options' => [
                    'Attacking agricultural systems',
                    'Using legitimate system tools for malicious purposes',
                    'Only conducting physical attacks',
                    'Avoiding all digital footprints'
                ],
                'correct_options' => ['Using legitimate system tools for malicious purposes'],
                'justifications' => [
                    'Not related to agriculture',
                    'Correct - Attackers use built-in tools like PowerShell to avoid detection',
                    'LotL is a digital attack technique',
                    'Still leaves traces, just harder to detect'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Polymorphic Malware - Item 29
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What makes polymorphic malware difficult for antivirus software to detect?',
                'options' => [
                    'It only runs on Linux',
                    'It changes its code signature with each infection',
                    'It\'s written in multiple languages',
                    'It only activates on holidays'
                ],
                'correct_options' => ['It changes its code signature with each infection'],
                'justifications' => [
                    'OS doesn\'t affect detection difficulty',
                    'Correct - Constantly changing signatures evade signature-based detection',
                    'Programming language doesn\'t matter',
                    'Activation timing isn\'t the issue'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Vulnerability Disclosure - Item 30
            [
                'topic_id' => $topics['Common Vulnerabilities & Exposures (CVE)'] ?? 131,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'In responsible disclosure, security researchers typically:',
                'options' => [
                    'Immediately publish exploit code publicly',
                    'Give vendors time to patch before public disclosure',
                    'Sell to the highest bidder',
                    'Never disclose vulnerabilities'
                ],
                'correct_options' => ['Give vendors time to patch before public disclosure'],
                'justifications' => [
                    'Immediate publication endangers users',
                    'Correct - Allows vendors to protect users before attackers learn of the vulnerability',
                    'Unethical and potentially illegal',
                    'Disclosure helps improve security'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            
            // Vulnerability Chaining - Item 32
            [
                'topic_id' => $topics['Common Vulnerabilities & Exposures (CVE)'] ?? 131,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'When attackers combine multiple vulnerabilities to achieve a goal, this is called:',
                'options' => [
                    'Vulnerability stacking',
                    'Exploit chaining',
                    'Bug bouncing',
                    'Threat multiplication'
                ],
                'correct_options' => ['Exploit chaining'],
                'justifications' => [
                    'Not a standard term',
                    'Correct - Chaining exploits bypasses individual defenses',
                    'Not a recognized technique',
                    'Doesn\'t describe the technique'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // EPSS Score - Item 33
            [
                'topic_id' => $topics['Common Vulnerability Scoring System (CVSS)'] ?? 132,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What does the Exploit Prediction Scoring System (EPSS) predict?',
                'options' => [
                    'Vulnerability severity',
                    'Probability of exploitation in the wild',
                    'Time to patch',
                    'Cost of remediation'
                ],
                'correct_options' => ['Probability of exploitation in the wild'],
                'justifications' => [
                    'CVSS measures severity, not EPSS',
                    'Correct - EPSS estimates likelihood a vulnerability will be exploited',
                    'EPSS doesn\'t estimate patch timing',
                    'Cost estimation isn\'t EPSS\'s purpose'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // Sandboxing - Item 34
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Security teams use sandboxes to:',
                'options' => [
                    'Permanently store malware',
                    'Safely analyze malware behavior',
                    'Create new malware',
                    'Speed up malware execution'
                ],
                'correct_options' => ['Safely analyze malware behavior'],
                'justifications' => [
                    'Sandboxes are for analysis, not storage',
                    'Correct - Isolated environments allow safe malware analysis',
                    'Sandboxes analyze, not create malware',
                    'Speed isn\'t the purpose'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Threat Modeling - Item 35
            [
                'topic_id' => $topics['Threats & Threat Actors'] ?? 123,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'STRIDE is a threat modeling framework. What does the \'R\' in STRIDE stand for?',
                'options' => [
                    'Ransomware',
                    'Repudiation',
                    'Reconnaissance',
                    'Remediation'
                ],
                'correct_options' => ['Repudiation'],
                'justifications' => [
                    'STRIDE categorizes threat types, not specific malware',
                    'Correct - Repudiation threats involve denying actions occurred',
                    'Not part of STRIDE acronym',
                    'STRIDE identifies threats, not fixes'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 1,
                'status' => 'published'
            ],
            
            // Attack Surface Reduction - Item 36
            [
                'topic_id' => $topics['Attack Surface & Enumeration'] ?? 125,
                'type_id' => 3,
                'dimension' => 'Technical',
                'content' => 'Select effective methods to reduce attack surface:',
                'options' => [
                    'Network segmentation',
                    'Installing more software',
                    'Disabling unused ports',
                    'Enabling all features',
                    'Regular patching',
                    'Using default configurations'
                ],
                'correct_options' => ['Network segmentation', 'Disabling unused ports', 'Regular patching'],
                'justifications' => [
                    'Limits lateral movement if compromised',
                    'More software increases attack surface',
                    'Fewer open ports mean fewer entry points',
                    'Unnecessary features increase risk',
                    'Patches eliminate known vulnerabilities',
                    'Defaults often have security weaknesses'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],
            
            // Fileless Malware - Item 37
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Fileless malware primarily resides in:',
                'options' => [
                    'Hard drive files',
                    'Memory and legitimate processes',
                    'USB devices',
                    'Network cables'
                ],
                'correct_options' => ['Memory and legitimate processes'],
                'justifications' => [
                    'Fileless means no traditional files',
                    'Correct - Lives in RAM and hijacks legitimate processes',
                    'Would make it file-based',
                    'Not possible in cables'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            // Bug Bounty Programs - Item 38
            [
                'topic_id' => $topics['Vulnerability Management Lifecycle'] ?? 130,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What is the primary benefit of bug bounty programs for organizations?',
                'options' => [
                    'Guaranteed elimination of all vulnerabilities',
                    'Crowdsourced vulnerability discovery',
                    'Reduced need for security staff',
                    'Compliance requirement fulfillment'
                ],
                'correct_options' => ['Crowdsourced vulnerability discovery'],
                'justifications' => [
                    'No program eliminates all vulnerabilities',
                    'Correct - Leverages global researcher community to find vulnerabilities',
                    'Supplements but doesn\'t replace security teams',
                    'Not typically a compliance requirement'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Threat Actor Attribution - Item 39
            [
                'topic_id' => $topics['Threats & Threat Actors'] ?? 123,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Why is threat actor attribution challenging?',
                'options' => [
                    'Attackers always leave clear signatures',
                    'False flags and obfuscation techniques',
                    'All attacks come from known groups',
                    'Attribution tools are 100% accurate'
                ],
                'correct_options' => ['False flags and obfuscation techniques'],
                'justifications' => [
                    'Sophisticated actors hide their tracks',
                    'Correct - Attackers deliberately mislead investigators and hide origins',
                    'Many attacks from unknown actors',
                    'Attribution involves significant uncertainty'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 4,
                'status' => 'published'
            ],
            
            // Vulnerability Scanner Limitations - Item 40
            [
                'topic_id' => $topics['Vulnerability Management Lifecycle'] ?? 130,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What type of vulnerabilities are traditional network scanners LEAST likely to detect?',
                'options' => [
                    'Missing patches',
                    'Business logic flaws',
                    'Open ports',
                    'Outdated software versions'
                ],
                'correct_options' => ['Business logic flaws'],
                'justifications' => [
                    'Scanners excel at detecting missing patches',
                    'Correct - Logic flaws require understanding application context, not just technical scanning',
                    'Port scanning is a basic capability',
                    'Version detection is standard functionality'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 5,
                'status' => 'published'
            ],
            
            // Weaponization Techniques - Item 41
            [
                'topic_id' => $topics['Cyber Kill Chain'] ?? 128,
                'type_id' => 5,
                'dimension' => 'Technical',
                'content' => 'Match each weaponization technique with its description:',
                'options' => [
                    'items' => [
                        'Embedding malware in legitimate documents',
                        'Creating fake websites mimicking real ones',
                        'Modifying legitimate software with backdoors',
                        'Crafting emails appearing from trusted sources'
                    ],
                    'targets' => [
                        'Trojanization',
                        'Watering hole preparation',
                        'Supply chain compromise',
                        'Spear phishing crafting'
                    ]
                ],
                'correct_options' => [
                    'Embedding malware in legitimate documents' => 'Trojanization',
                    'Creating fake websites mimicking real ones' => 'Watering hole preparation',
                    'Modifying legitimate software with backdoors' => 'Supply chain compromise',
                    'Crafting emails appearing from trusted sources' => 'Spear phishing crafting'
                ],
                'justifications' => [
                    'Embedding malware in legitimate documents' => 'Classic trojan horse technique',
                    'Creating fake websites mimicking real ones' => 'Prepares watering hole attacks',
                    'Modifying legitimate software with backdoors' => 'Compromises software supply chain',
                    'Crafting emails appearing from trusted sources' => 'Social engineering for targeted attacks'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],
            
            // Ransomware Evolution - Item 42
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Modern ransomware groups often use "double extortion." What does this mean?',
                'options' => [
                    'Charging twice for the same decryption key',
                    'Encrypting data AND threatening to leak it',
                    'Attacking two companies simultaneously',
                    'Using two different encryption algorithms'
                ],
                'correct_options' => ['Encrypting data AND threatening to leak it'],
                'justifications' => [
                    'Payment is typically once per incident',
                    'Correct - Victims face encryption AND data exposure threats',
                    'Targets are usually focused, not simultaneous',
                    'Multiple algorithms don\'t define double extortion'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 2,
                'status' => 'published'
            ],
            
            
            
            // Threats & Threat Actors - Emerging Threat Landscape - Item 45
            [
                'topic_id' => $topics['Threats & Threat Actors'] ?? 123,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which emerging technology presents new attack surfaces for threat actors in 2024 and beyond?',
                'options' => [
                    'Fax machines',
                    'AI/ML systems',
                    'Dial-up modems',
                    'Pagers'
                ],
                'correct_options' => ['AI/ML systems'],
                'justifications' => [
                    'Largely obsolete technology',
                    'Correct - AI systems introduce model poisoning, adversarial inputs, and new attack vectors',
                    'Outdated technology',
                    'Minimal modern usage'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 5,
                'status' => 'published'
            ],

            // Threat Vectors - Social Engineering Analysis - Item 46 (Bloom 3)
            [
                'topic_id' => $topics['Threat Vectors'] ?? 124,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'In a vishing attack, how do attackers typically establish credibility with their targets?',
                'options' => [
                    'Using automated voice messages only',
                    'Researching targets and using personal information',
                    'Speaking in foreign accents',
                    'Calling at random times'
                ],
                'correct_options' => ['Researching targets and using personal information'],
                'justifications' => [
                    'Automation reduces credibility',
                    'Correct - Social engineering relies on personal details to build trust',
                    'Accents would reduce credibility',
                    'Timing is strategic, not random'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Attack Surface & Enumeration - Network Discovery - Item 47 (Bloom 3)
            [
                'topic_id' => $topics['Attack Surface & Enumeration'] ?? 125,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What information can attackers gather from analyzing DNS records during reconnaissance?',
                'options' => [
                    'Only IP addresses',
                    'Subdomains, mail servers, and network infrastructure',
                    'User passwords',
                    'Firewall configurations'
                ],
                'correct_options' => ['Subdomains, mail servers, and network infrastructure'],
                'justifications' => [
                    'DNS contains much more than IP addresses',
                    'Correct - DNS records reveal network topology and services',
                    'Passwords are not stored in DNS',
                    'Firewall configs are not in DNS records'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Malware Families - Command and Control - Item 48 (Bloom 3)
            [
                'topic_id' => $topics['Malware Families'] ?? 126,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'How do modern malware families evade detection of their command and control communications?',
                'options' => [
                    'Using only HTTP traffic',
                    'Domain generation algorithms and encrypted channels',
                    'Sending emails only',
                    'Using only internal networks'
                ],
                'correct_options' => ['Domain generation algorithms and encrypted channels'],
                'justifications' => [
                    'HTTP alone is easily monitored',
                    'Correct - DGAs create unpredictable domains, encryption hides content',
                    'Email is too limited for C2',
                    'Malware needs external communication'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // MITRE ATT&CK Framework - Persistence Techniques - Item 49 (Bloom 3)
            [
                'topic_id' => $topics['MITRE ATT&CK Framework'] ?? 127,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which MITRE ATT&CK technique involves modifying system startup to maintain persistence?',
                'options' => [
                    'Process Injection',
                    'Boot or Logon Autostart Execution',
                    'Data Exfiltration',
                    'Credential Dumping'
                ],
                'correct_options' => ['Boot or Logon Autostart Execution'],
                'justifications' => [
                    'Process injection is for privilege escalation',
                    'Correct - T1547 covers startup modification for persistence',
                    'Exfiltration is for data theft',
                    'Credential dumping is for privilege escalation'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Cyber Kill Chain - Lateral Movement - Item 50 (Bloom 3)
            [
                'topic_id' => $topics['Cyber Kill Chain'] ?? 128,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'After establishing a foothold, attackers typically perform lateral movement to:',
                'options' => [
                    'Exit the network immediately',
                    'Access additional systems and escalate privileges',
                    'Send spam emails',
                    'Update their malware'
                ],
                'correct_options' => ['Access additional systems and escalate privileges'],
                'justifications' => [
                    'Initial foothold is just the beginning',
                    'Correct - Lateral movement expands access to reach target objectives',
                    'Spam is not typical of targeted attacks',
                    'Updates happen via C2, not lateral movement'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Threat Indicators - Attribution Challenges - Item 51 (Bloom 3)
            [
                'topic_id' => $topics['Threat Indicators'] ?? 129,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'What technique do advanced threat actors use to mislead attribution efforts?',
                'options' => [
                    'Using only well-known tools',
                    'False flag operations with fake artifacts',
                    'Always using the same infrastructure',
                    'Publishing detailed attack plans'
                ],
                'correct_options' => ['False flag operations with fake artifacts'],
                'justifications' => [
                    'Well-known tools don\'t mislead attribution',
                    'Correct - Planting fake clues to implicate other actors',
                    'Consistent infrastructure aids attribution',
                    'Publication would reveal true identity'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Vulnerability Management Lifecycle - Risk Assessment - Item 52 (Bloom 3)
            [
                'topic_id' => $topics['Vulnerability Management Lifecycle'] ?? 130,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'When assessing vulnerability risk, which factor indicates the highest urgency for patching?',
                'options' => [
                    'High CVSS score only',
                    'Vulnerability in internet-facing system with known exploits',
                    'Vendor recommendation',
                    'Age of the vulnerability'
                ],
                'correct_options' => ['Vulnerability in internet-facing system with known exploits'],
                'justifications' => [
                    'CVSS alone doesn\'t consider context',
                    'Correct - Combines exposure, exploitability, and impact',
                    'Vendors may not understand your environment',
                    'Age alone doesn\'t determine urgency'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Common Vulnerabilities & Exposures (CVE) - Impact Analysis - Item 53 (Bloom 3)
            [
                'topic_id' => $topics['Common Vulnerabilities & Exposures (CVE)'] ?? 131,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'How should organizations prioritize CVE remediation when facing resource constraints?',
                'options' => [
                    'Patch everything simultaneously',
                    'Focus on vulnerabilities affecting critical business assets first',
                    'Start with oldest vulnerabilities',
                    'Patch based on alphabetical order'
                ],
                'correct_options' => ['Focus on vulnerabilities affecting critical business assets first'],
                'justifications' => [
                    'Simultaneous patching is often impossible',
                    'Correct - Business impact drives priority in resource-constrained environments',
                    'Age doesn\'t correlate with business risk',
                    'Alphabetical order ignores risk'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Common Vulnerability Scoring System (CVSS) - Environmental Metrics - Item 54 (Bloom 3)
            [
                'topic_id' => $topics['Common Vulnerability Scoring System (CVSS)'] ?? 132,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Why are CVSS environmental metrics important for accurate risk assessment?',
                'options' => [
                    'They increase the base score',
                    'They customize scoring based on organizational context',
                    'They are required by law',
                    'They predict future vulnerabilities'
                ],
                'correct_options' => ['They customize scoring based on organizational context'],
                'justifications' => [
                    'Environmental metrics adjust, not just increase scores',
                    'Correct - Considers how vulnerability affects specific environments',
                    'Not legally mandated',
                    'CVSS assesses current, not future vulnerabilities'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Common Weakness Enumeration (CWE) - Root Cause Analysis - Item 55 (Bloom 3)
            [
                'topic_id' => $topics['Common Weakness Enumeration (CWE)'] ?? 133,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'How does understanding CWE classifications help in vulnerability management?',
                'options' => [
                    'Provides patch release dates',
                    'Identifies underlying weakness patterns for systematic fixes',
                    'Lists all affected vendors',
                    'Gives exploitation difficulty ratings'
                ],
                'correct_options' => ['Identifies underlying weakness patterns for systematic fixes'],
                'justifications' => [
                    'CWE doesn\'t track patch timing',
                    'Correct - Understanding weakness types enables comprehensive remediation strategies',
                    'CWE categorizes weaknesses, not vendors',
                    'CVSS handles difficulty, not CWE'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // National Vulnerability Database (NVD) - Data Sources - Item 56 (Bloom 3)
            [
                'topic_id' => $topics['National Vulnerability Database (NVD)'] ?? 134,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Besides NVD, what other sources should organizations use for comprehensive vulnerability intelligence?',
                'options' => [
                    'Only vendor advisories',
                    'Security research blogs and threat intelligence feeds',
                    'Social media only',
                    'Wikipedia entries'
                ],
                'correct_options' => ['Security research blogs and threat intelligence feeds'],
                'justifications' => [
                    'Vendor advisories alone may miss threats',
                    'Correct - Multiple sources provide comprehensive threat picture',
                    'Social media lacks technical depth',
                    'Wikipedia is not authoritative for security'
                ],
                'difficulty_level' => 2,
                'bloom_level' => 3,
                'status' => 'published'
            ],

            // Zero-Day Vulnerabilities - Detection Strategies - Item 57 (Bloom 4)
            [
                'topic_id' => $topics['Zero-Day Vulnerabilities'] ?? 135,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which approach is most effective for detecting zero-day attacks?',
                'options' => [
                    'Signature-based antivirus only',
                    'Behavioral analysis and anomaly detection',
                    'Patch management systems',
                    'User training alone'
                ],
                'correct_options' => ['Behavioral analysis and anomaly detection'],
                'justifications' => [
                    'Signatures don\'t exist for zero-days',
                    'Correct - Behavioral patterns can detect unknown threats',
                    'No patches exist for zero-days',
                    'Training helps but can\'t detect all zero-days'
                ],
                'difficulty_level' => 3,
                'bloom_level' => 4,
                'status' => 'published'
            ],

            // End-of-Life / End-of-Support (EOL/EOS) - Risk Mitigation - Item 58 (Bloom 5)
            [
                'topic_id' => $topics['End-of-Life / End-of-Support (EOL/EOS)'] ?? 136,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Evaluate the best strategy for managing critical EOL systems that cannot be immediately replaced:',
                'options' => [
                    'Accept all risks and continue normal operations',
                    'Implement compensating controls and network isolation',
                    'Disable all network connections',
                    'Ignore the EOL status'
                ],
                'correct_options' => ['Implement compensating controls and network isolation'],
                'justifications' => [
                    'Accepting all risks is irresponsible',
                    'Correct - Layered defenses can mitigate risks until replacement',
                    'Complete isolation may break business functionality',
                    'EOL status creates real security risks'
                ],
                'difficulty_level' => 4,
                'bloom_level' => 5,
                'status' => 'published'
            ],

            // Hardening Standards - Item 43
            [
                'topic_id' => $topics['System & Application Hardening'] ?? 137,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Which organization provides widely-used system hardening benchmarks?',
                'options' => [
                    'Center for Internet Security (CIS)',
                    'World Health Organization (WHO)',
                    'International Monetary Fund (IMF)',
                    'UNESCO'
                ],
                'correct_options' => ['Center for Internet Security (CIS)'],
                'justifications' => [
                    'Correct - CIS Benchmarks are industry-standard hardening guides',
                    'WHO focuses on health, not cybersecurity',
                    'IMF handles financial matters',
                    'UNESCO covers education and culture'
                ],
                'difficulty_level' => 1,
                'bloom_level' => 1,
                'status' => 'published'
            ],

            // System & Application Hardening - Security Architecture - Item 59 (Bloom 5)
            [
                'topic_id' => $topics['System & Application Hardening'] ?? 137,
                'type_id' => 1,
                'dimension' => 'Technical',
                'content' => 'Assess the most effective approach for hardening cloud-native applications:',
                'options' => [
                    'Apply traditional server hardening guides',
                    'Implement container-specific hardening with immutable infrastructure',
                    'Rely solely on cloud provider security',
                    'Use only network-based controls'
                ],
                'correct_options' => ['Implement container-specific hardening with immutable infrastructure'],
                'justifications' => [
                    'Traditional guides miss cloud-native threats',
                    'Correct - Container security requires specialized approaches',
                    'Shared responsibility requires customer hardening',
                    'Network controls alone are insufficient'
                ],
                'difficulty_level' => 4,
                'bloom_level' => 5,
                'status' => 'published'
            ]
        ];
        
        // Insert all items
        foreach ($items as $item) {
            DiagnosticItem::create($item);
        }
        
        $this->command->info('Domain 7 (Threat & Vulnerability Management) diagnostic items seeded successfully!');
    }
}